<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Qu·∫£n l√Ω ƒê∆°n h√†ng</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #fffde7;
    }

    .sidebar {
      position: fixed;
      width: 220px;
      height: 100%;
      background: #ffb300;
      padding: 20px;
      color: white;
    }

    .sidebar h2 {
      margin-bottom: 30px;
    }

    .sidebar a {
      display: block;
      color: white;
      text-decoration: none;
      margin: 15px 0;
      font-weight: bold;
    }

    .main {
      margin-left: 240px;
      padding: 40px;
    }

    h1 {
      margin-bottom: 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 10px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.05);
      overflow: hidden;
    }

    th, td {
      padding: 12px;
      border-bottom: 1px solid #eee;
      text-align: left;
    }

    th {
      background: #ffecb3;
      color: #333;
    }

    .status {
      padding: 5px 12px;
      border-radius: 15px;
      font-weight: bold;
      font-size: 0.9rem;
      display: inline-block;
    }

    .pending {
      background: #ff9800;
      color: white;
    }

    .completed {
      background: #4caf50;
      color: white;
    }

    .actions button {
      padding: 6px 10px;
      border: none;
      border-radius: 5px;
      margin-right: 5px;
      cursor: pointer;
      font-weight: bold;
    }

    .confirm {
      background: #2196f3;
      color: white;
    }

    .delete {
      background: #f44336;
      color: white;
    }
  </style>
</head>
<body>
  <div class="sidebar">
    <h2>Admin Panel</h2>
    <a href="dashboard.html">üìä T·ªïng quan</a>
    <a href="monan.html">üçΩÔ∏è Qu·∫£n l√Ω m√≥n ƒÉn</a>
    <a href="donhang.html">üßæ Qu·∫£n l√Ω ƒë∆°n h√†ng</a>
    <a href="../index.html">‚Ü©Ô∏è Trang ch√≠nh</a>
  </div>

  <div class="main">
    <h1>üßæ Danh s√°ch ƒë∆°n h√†ng</h1>
    <table>
      <thead>
        <tr>
          <th>STT</th>
          <th>Kh√°ch h√†ng</th>
          <th>SƒêT</th>
          <th>ƒê·ªãa ch·ªâ</th>
         
          <th>Tr·∫°ng th√°i</th>
          <th>Thao t√°c</th>
        </tr>
      </thead>
      <tbody>
    
      </tbody>
    </table>
  </div>

  <script>
  fetch("../backend/get_orders.php")
    .then(res => {
      if (!res.ok) throw new Error("L·ªói HTTP " + res.status);
      return res.json();
    })
    .then(data => {
      if (!Array.isArray(data)) {
        throw new Error("D·ªØ li·ªáu kh√¥ng h·ª£p l·ªá");
      }

      const tbody = document.querySelector("tbody");
      tbody.innerHTML = "";

      data.forEach((order, index) => {
        tbody.innerHTML += `
          <tr>
            <td>${index + 1}</td>
            <td>${order.customer_name}</td>
            <td>${order.phone}</td>
            <td>${order.address}</td>
            <td><span class="status ${order.status === 'completed' ? 'completed' : 'pending'}">
              ${order.status === 'completed' ? 'ƒê√£ giao' : 'Ch·ªù x·ª≠ l√Ω'}
            </span></td>
            <td class="actions">
              <button class="confirm" onclick="confirmOrder(${order.id})">X√°c nh·∫≠n</button>
              <button class="delete" onclick="deleteOrder(${order.id})">X√≥a</button>
            </td>
          </tr>`;
      });
    })
    .catch(err => {
      console.error("L·ªói khi t·∫£i ƒë∆°n h√†ng:", err);
      alert("Kh√¥ng th·ªÉ t·∫£i ƒë∆°n h√†ng. Ki·ªÉm tra k·∫øt n·ªëi ho·∫∑c d·ªØ li·ªáu server.");
    });

  function confirmOrder(id) {
    fetch(`../backend/update_order.php`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ id, status: 'completed' })
    }).then(() => location.reload());
  }

  function deleteOrder(id) {
    if (confirm("X√≥a ƒë∆°n h√†ng n√†y?")) {
      fetch(`../backend/delete_order.php`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ id })
      }).then(() => location.reload());
    }
  }
</script>

</body>
</html>
